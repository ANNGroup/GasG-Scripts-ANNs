% Name of code: ScriptANN18
% Developer and contact address: A. Acevedo-Anicasio and Instituto de 
% Energias Renovables, Universidad Nacional Autonoma de Mexico; Priv. 
% Xochicalco s/n, Temixco, 62580
% Morelos, Mexico
% Telephone number: Tel.: +52 (55) 5622-9774, Fax: +52 (55)5622-9791
% e-mail: esg@ier.unam.mx

% Year first available: 2018
% Suggested hardware: Intel Core Processor i5-2300, 2.80GHz, Ram Memory 
% 4 GB, and  a Hard drive 500 GB
% Software requirements: Matlab for Windows v. R2017b (MathWorks, 2017)
% Programming language: MATLAB
% Programming file size: 44 kB with 259 lines of code

clear all
close all
clc

%target: square root(BHT(°C)) 
t = [15.45962483	15.8113883	17	17.20465053	17.4642492	17.17556404	16.58312395	16.58312395	16.43167673	16.88194302	17.88854382	16.73320053	17.17556404	17.02938637	16.73320053	17.4642492	17.88854382	18.08314132	18.02775638	18.16590212	18.16590212	18.16590212	18	18.43908891	17.02938637	17.32050808	17.32050808	17.32050808	13.03840481	13.03840481	15	17.88854382	15.49193338	17.32050808	17.32050808	18.02775638	17.17556404	17.32050808	14.6628783	15.71623365	17.29161647	13.49073756	14.6628783	15	17.02938637	16.73320053	17.88854382	15.49193338	15.49193338	16.673332	17.49285568	15.8113883	15.8113883	16.1245155	16.1245155	15.49193338	16.1245155	16.1245155	16.43167673	15.8113883	15.8113883	15.49193338	15.49193338	15.49193338	15.8113883	15.8113883	15.16575089	16.1245155	15.49193338	15.8113883	15.49193338	15.49193338	15.8113883	15.49193338	15.49193338	15.8113883	15.8113883	16.1245155	15.8113883	15.49193338	16.43167673	14.56021978	15.68438714	15.42724862	14.31782106	14.73091986	14.6628783	18.38477631	18.52025918	18.02775638	18.02775638	16.76305461	16.76305461	16.76305461	17.11724277	17.11724277	17.11724277	17.43559577	17.43559577	17.43559577	16.70329309	16.70329309	17.32050808	17.32050808	17.32050808	17.08800749	17.08800749	17.08800749	17.20465053	17.20465053	17.20465053	16.73320053	16.73320053	16.73320053	17.49285568	17.49285568	17.49285568	16.94107435	16.94107435	16.94107435	17.72004515	17.72004515	17.74823935	17.74823935	16.34013464	16.46207763	16.46207763	16.46207763	16.46207763	16.46207763	16.46207763	16.46207763	16.46207763	16.46207763	16.46207763	16.46207763	16.46207763	16.46207763	16.46207763	16.46207763	16.46207763	16.46207763	16.46207763	16.46207763	16.46207763	16.46207763	16.46207763	16.46207763	16.46207763	16.46207763	16.94107435	16.94107435	16.94107435	16.94107435	16.94107435	16.94107435	16.94107435	16.94107435	16.94107435	16.94107435	16.94107435	16.94107435	16.94107435	16.94107435	16.94107435	16.94107435	16.94107435	16.94107435	16.46207763	16.46207763	16.46207763	16.46207763	16.46207763	16.46207763	16.46207763	16.46207763	16.64331698	16.64331698	16.64331698	16.64331698	16.64331698	16.64331698	16.64331698	17.3781472	17.3781472	17.3781472	17.3781472	17.3781472	17.3781472	17.3781472	17.3781472	17.3781472	15.74801575	15.74801575	16.673332	16.673332	16.673332	16.673332	17.3781472	17.3781472	17.3781472	17.3781472	17.3781472	17.3781472	17.3781472	17.3781472	17.3781472	16.73320053	16.2788206	16.2788206	16.2788206	16.2788206	16.2788206	16.2788206	16.2788206	16.2788206	16.2788206	16.2788206	16.2788206	16.61324773	16.61324773	16.61324773	16.61324773	16.61324773	16.61324773	16.34013464	16.34013464	16.34013464	16.34013464	16.34013464	16.34013464	16.34013464	18.27566688	18.27566688	16.18641406	16.18641406	16.673332	16.55294536	16.55294536	16.55294536	16.55294536	16.55294536	18.76166304	18.76166304	17.63519209	17.63519209	17.63519209	17.20465053	17.20465053	17.20465053	17.20465053	17.20465053	17.20465053	17.20465053	17.20465053	17.20465053	17.20465053	17.20465053	17.20465053	17.20465053	17.20465053	17.20465053	17.20465053	17.20465053	17.20465053	17.20465053	17.20465053	17.20465053	17.20465053	17.20465053	17.20465053	17.34935157	17.34935157	16.76305461	18.08314132	18.08314132	18.13835715	18.13835715	18.13835715	18.13835715	18.13835715	18.13835715	18.13835715	18.13835715	18.13835715	18.13835715	18.13835715	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	14.28285686	19.59591794	19.59591794	19.59591794	19.59591794	18.86796226	18.86796226	18.86796226	18.86796226	16.37070554	17.8605711	17.8605711	17.8605711	17.8605711	17.8605711	16.34013464	16.34013464	16.34013464	16.34013464	16.18641406	16.18641406	16.18641406	18.16590212	18.16590212	19.05255888	17.43559577	17.32050808	18.70828693	17.02938637	17.94435844	17.94435844	17.94435844	17.94435844	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	18.43908891	16.85229955	16.85229955	16.85229955	16.85229955	17.52141547	17.52141547];

%BHT(°C)
tCelsiusDegrees = [239	250	289	296	305	295	275	275	270	285	320	280	295	290	280	305	320	327	325	330	330	330	324	340	290	300	300	300	170	170	225	320	240	300	300	325	295	300	215	247	299	182	215	225	290	280	320	240	240	278	306	250	250	260	260	240	260	260	270	250	250	240	240	240	250	250	230	260	240	250	240	240	250	240	240	250	250	260	250	240	270	212	246	238	205	217	215	338	343	325	325	281	281	281	293	293	293	304	304	304	279	279	300	300	300	292	292	292	296	296	296	280	280	280	306	306	306	287	287	287	314	314	315	315	267	271	271	271	271	271	271	271	271	271	271	271	271	271	271	271	271	271	271	271	271	271	271	271	271	271	287	287	287	287	287	287	287	287	287	287	287	287	287	287	287	287	287	287	271	271	271	271	271	271	271	271	277	277	277	277	277	277	277	302	302	302	302	302	302	302	302	302	248	248	278	278	278	278	302	302	302	302	302	302	302	302	302	280	265	265	265	265	265	265	265	265	265	265	265	276	276	276	276	276	276	267	267	267	267	267	267	267	334	334	262	262	278	274	274	274	274	274	352	352	311	311	311	296	296	296	296	296	296	296	296	296	296	296	296	296	296	296	296	296	296	296	296	296	296	296	296	301	301	281	327	327	329	329	329	329	329	329	329	329	329	329	329	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	204	384	384	384	384	356	356	356	356	268	319	319	319	319	319	267	267	267	267	262	262	262	330	330	363	304	300	350	290	322	322	322	322	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	340	284	284	284	284	307	307];

%inputs: log(CO2), log(H2S), log(CH4), log(H2) mmol/mol
p = [2.599883072	3.505963518	3.315130317	3.021189299	2.897627091	3.08278537	2.832436536	2.927172748	2.918052612	2.643131096	2.597821462	2.816973752	2.654670833	2.653091557	2.821369391	2.748694478	2.945082135	2.915779744	2.891307328	2.918799261	2.812869929	2.939399003	2.919597228	2.905609938	2.879052516	2.972269998	2.967739292	2.963778317	2.852469571	2.880851883	2.880777672	2.87443922	2.782479044	2.864925201	2.880586589	2.907267179	2.89555792	2.927228301	2.929949786	2.84962431	2.79345478	2.934653507	2.832833003	2.85631358	2.718619501	2.702392668	2.492997608	2.972333053	2.96021776	2.903813209	2.515343893	2.973681919	2.972896784	2.981320173	2.971090213	2.980730377	2.972758084	2.972017599	2.967781908	2.969788537	2.985471383	2.988068203	2.988246723	2.987040287	2.991359003	2.991624735	2.987755617	2.978682565	2.987978916	2.972017599	2.981546805	2.973497309	2.972573081	2.979684924	2.977586438	2.978819387	2.984752278	2.970997366	2.974879973	2.967454368	2.975477763	2.92992956	2.829946696	2.919601024	2.87909588	2.92788341	2.856124444	2.936308488	2.956247814	2.917768002	2.912753304	2.85308953	2.943988875	2.928754202	2.912487761	2.943494516	2.930184652	2.943494516	2.91481898	2.931203525	2.940018155	2.944137073	2.917663024	2.940516485	2.929623252	2.926445348	2.934498451	2.907894835	2.942008053	2.92680531	2.916559219	2.9160853	2.91750551	2.907787443	2.959518377	2.896526217	2.915558115	2.936161741	2.942008053	2.911157609	2.923554858	2.924795996	2.92890769	2.9263939	2.992995098	2.984527313	2.993876915	2.993876915	2.982017821	2.979484637	2.989004616	2.978124799	2.978929725	2.98721923	2.98721923	2.987487506	2.989004616	2.986323777	2.985426474	2.985246791	2.982723388	2.984077034	2.984527313	2.984527313	2.983144824	2.985785618	2.981818607	2.981818607	2.951477889	2.976046124	2.969004256	2.962369336	2.947433722	2.942999593	2.991669007	2.942999593	2.909020854	2.953759692	2.980911938	2.946943271	2.894869657	2.991491889	2.991491889	2.942999593	2.909020854	2.912328358	2.912222057	2.658992461	2.993876915	2.993612558	2.994382431	2.993876915	2.995648355	2.995766779	2.995635195	2.993707304	2.991226076	2.966610987	2.982723388	2.945258773	2.937317248	2.937517892	2.892159539	2.984717641	2.990605211	2.990782692	2.983490972	2.966563645	2.983626287	2.983626287	2.98376156	2.98376156	2.966681702	2.973641773	2.994980881	2.994396348	2.99206726	2.992111488	2.993876915	2.967547976	2.943711609	2.973589623	2.927872829	2.971739591	2.940964493	2.941014244	2.924584219	2.612299507	2.994141111	2.994141111	2.994141111	2.994317153	2.982622215	2.982736945	2.989762966	2.988380565	2.970727995	2.971867033	2.974433393	2.981237886	2.977944354	2.989004616	2.989093693	2.989093693	2.981637425	2.989891897	2.993083361	2.985431478	2.991491889	2.991491889	2.991669007	2.988068203	2.889146479	2.900123418	2.9870532	2.984133344	2.783982859	2.989894564	2.986323777	2.988870966	2.972849631	2.959394112	2.983151769	2.980548739	2.987800286	2.881328281	2.940541386	2.988074899	2.994756945	2.994756945	2.98804475	2.989894564	2.984932616	2.985536493	2.987676541	2.992995098	2.989004616	2.989004616	2.989449818	2.989568609	2.990427658	2.989820323	2.986771734	2.986771734	2.987934265	2.98811284	2.98721923	2.988558957	2.98811284	2.986323777	2.955221945	2.976488454	2.958382674	2.980169078	2.939423356	2.968232106	2.975086993	2.960632478	2.963787827	2.97053283	2.963835031	2.963835031	2.945507483	2.934031586	2.889062915	2.975727671	2.983912115	2.986413897	2.986424013	2.99024805	2.964093594	2.995611417	2.997464608	2.991429667	2.992269832	2.992762029	2.995058118	2.994403119	2.994508633	2.994957648	2.993500554	2.991507432	2.99161746	2.979724623	2.987937511	2.992132606	2.993333798	2.992155711	2.996312248	2.995000384	2.992957555	2.994849629	2.992573721	2.993787746	2.992013975	2.983490972	2.983490972	2.996524392	2.992959888	2.994007868	2.993646885	2.988524211	2.996371163	2.990826629	2.987405763	2.99106574	2.989940206	2.977394779	2.991445029	2.989218563	2.995628373	2.988474332	2.988640764	2.997362452	2.986285987	2.990050602	2.991243856	2.991305578	2.977747122	2.987195309	2.988876627	2.993307711	2.98236619	2.990835913	2.987996649	2.986000655	2.983175072	2.98804985	2.984370003	2.995123588	2.992979884	2.975653933	2.973495068	2.886609386	2.967607021	2.962703546	2.980230691	2.980230691	2.95616843	2.94957153	2.957128198	2.960851154	2.960851154	2.891217335	2.922334139	2.916717078	2.870403905	2.935859798	2.9263939	2.966327101	2.940018155	2.95477299	2.95477299	2.972665592	2.983941859	2.983941859	2.95616843	2.936721928	2.844340529	2.893432645	2.920144694	2.944135831	2.890973894	2.944982087	2.944581364	2.944581364	2.943494516	2.975390037	2.949569254	2.951702824	2.945927609	2.986627798	2.970971715	2.970392764	2.980073534	2.966112169	2.959023309	2.967502138	2.959626531	2.966589095	2.978917586	2.968477105	2.960157658	2.960234018	2.95215296	2.967460703	2.912164854	2.951851721	2.969937902	2.971176949	2.959000735	2.95883671	2.959451636	2.969793697	2.959686313	2.964067661	2.955681604	2.95883587	2.946976951	2.972909607	2.964740947	2.927995863	2.956851246	2.965174459	2.969538945	2.965353969	2.951335499	2.962369336	2.971603793	2.962179706	2.932657499	2.954176072	2.954527361	2.95478743	2.968059422	2.929324374	2.961893258	2.948192474	2.969295896	2.942996049	2.950420325	2.963132947	2.952920935	2.935983085	2.963304112	2.941419955	2.959460897	2.9495325	2.961404213	2.96501357	2.971311555	2.965561517	2.94100306	2.968575041	2.981541583	2.958844393	2.958017476	2.961994516	2.969934797	2.959055089	2.963797245	2.97680605	2.955558841	2.970563261	2.966655671	2.936825373	2.96939205	2.950322863	2.966487788	2.957914627	2.962344508	2.964790995	2.950539202	2.966871117	2.963165119	2.893493525	2.960585464	2.954916315	2.965117731	2.957490279	2.947299193	2.963466138	2.963822554	2.964744957	2.974565167	2.952451964	2.955686819	2.96571897	2.96571897	2.919672273	2.950687194	2.961067517	2.948710431	2.941219257	2.964279755	2.961658977	2.944744359	2.964145005	2.953359283	2.931417574	2.96159557	2.956229119	2.924626413	2.946350847	2.954144867	2.953378859	2.951633579	2.965986561	2.956500795	2.964151068	2.957977762	2.953262223	2.954455596	2.951716674	2.947798161	2.962287018	2.95357619	2.95226505	2.913662712	2.891685021	2.895764395	2.976577317	2.974971994	2.975707464	2.975707464	2.942008053	2.879573415
1.523746467	1.704150517	1.854913022	2.113943352	2.294466226	1	2.341526997	1.811615916	2.010462124	2.552391689	2.496323788	2.26519157	2.459666811	2.46998802	2.26747296	2.439782334	1.884315134	1.992413801	1.979617169	1.922889977	1.596553668	1.824806966	1.929439544	2.081701197	2.03583862	1.568596489	1.627270695	1.6160963	2.064447566	2.12739289	1.979157381	2.020567256	1.374239078	1.837772955	1.066804122	1.652564668	0.558740948	1.820343689	2.031286504	1.706956807	2.275267254	2.073741193	1.509611697	1.793370674	2.307654691	2.277250376	2.324042042	1.155380177	1.505303004	2.159032183	2.361368613	1.281033367	1.305351369	1.139879086	1.170261715	1.136720567	1.294466226	1.29666519	1.411619706	1.369215857	1	0.939519253	0.934498451	1.033423755	0.707570176	0.662757832	1.012837225	1.305351369	0.963787827	1.298853076	1	1.307496038	1.320146286	1.11058971	1.250420002	1.190331698	0.991226076	1.357934847	1.227886705	1.354108439	1.264817823	1.740362689	1.612783857	2.041392685	1.84509804	1.954242509	1.770852012	1.955613643	0.872159234	1.772321707	1.725911632	1.755112266	1.678518379	1.762678564	1.698100546	1.582063363	1.559906625	1.677606953	1.898176483	1.731588765	1.718501689	1.501059262	1.849419414	1.691965103	1.755112266	1.825426118	1.731588765	1.920645001	1.683047038	1.745855195	1.763427994	1.764176132	1.77524626	1.760422483	1.419955748	1.705007959	1.720985744	1.654176542	1.684845362	1.788168371	1.745855195	1.758154622	1.704150517	1.73479983	0.986771734	1.399673721	0.968482949	0.968482949	1.45484486	1.496583734	1.278753601	1.471482407	1.501497446	1.357934847	1.357934847	1.322219295	1.230448921	1.342422681	1.374748346	1.374198258	1.477121255	1.374748346	1.428134794	1.428134794	1.436210369	1.303735889	1.419955748	1.419955748	1.467608106	1.442087642	1.003460532	0.491361694	0.973127854	0.973127854	0.991226076	0.995635195	0.851258349	0.886490725	0.662757832	0.838849091	1.012837225	0.990338855	0.990338855	1	0.851258349	0.892651034	0.892094603	1.043322974	0.72427587	0.768638101	0.766075826	0.826074803	0.770115295	0.770115295	0.770852012	0.834547858	1.178976947	1.804820679	1.421603927	1.829696069	1.981138783	1.981365509	2.026178259	1.248414697	1.183269844	1.184691431	1.403120521	1.446507797	1.290034611	1.389166084	1.389166084	1.389166084	1.515586744	1.444622429	0.562324156	0.739255803	0.936010796	0.934498451	0.968482949	1.684845362	1.823206788	1.582063363	1.813731208	1.432969291	1.921426341	1.921166051	1.983143469	1.380464506	0.883093359	0.883093359	0.883093359	0.880813592	0.947778413	0.949390007	0.953324696	1.005609445	0.954242509	1.010299957	1.290034611	1.35626661	1.274919506	1.096910013	1.097604329	1.097604329	1.361160995	1.073828284	0.985426474	1.039481844	1.053078443	1.053078443	1.053078443	1.23146959	1.923431552	2.00545079	1.309649455	1.383312586	1.518895425	1.033423755	1.396199347	0.843232778	1.250712686	1.21417554	1.381203469	1.463743721	1.214843848	2.032425809	1.918549292	1.246129126	0.851258349	0.851258349	1.242896118	1.204119983	1.274988682	1.288450448	1.204119983	0.968482949	1.235528447	1.245512668	1.225309282	1.189125207	1.164352856	1.163071882	1.290034611	1.290034611	1.225309282	1.225309282	1.301029996	1.204119983	1.235528447	1.220108088	1.107650826	1.542987168	1.703421287	1.416880373	1.936512963	1.367896123	1.633165354	1.812244697	1.794488047	1.65724713	1.794488047	1.794488047	1.871596284	1.795567213	1.761589588	1.498999364	1.313888302	1.068842412	1.068346152	1.139605811	1.859575608	0.105222734	0.45329659	1.193519471	1.068135624	1.063299189	0.243097027	0.194869983	0.873004876	0.808340296	0.915668289	1.226875573	1.219586123	1.301885699	1.322998335	1.03653009	0.785664649	1.037426498	-0.131825135	0.744325123	0.915256809	0.708180282	1.018995052	0.628070339	0.829987718	1.469822016	1.469822016	0.400229823	0.834771626	0.858096	0.816810507	1.280812548	0.054524654	1.104118431	1.136033096	0.97972364	1.186890464	1.559236272	1.071119103	1.074951485	0.459896147	1.154683727	1.247581093	-0.986486706	1.362311105	1.039341121	1.093975067	1.040908253	1.482602495	1.267190862	0.943429745	0.521806964	1.485071586	0.892494229	0.565926666	0.981451792	1.041392685	1.139005698	1.030417434	-0.135374334	0.182677524	1.565498377	1.528263615	2.157289769	1.608115955	1.677698618	1.553276046	1.553276046	1.84509804	1.661033086	1.707570176	1.75089392	1.75089392	2.125114341	2.017188698	1.987040287	2.245512668	1.96425963	2.022222105	1.590191239	1.819543936	1.802636918	1.802636918	1.579783597	1.41313205	1.41313205	1.785329835	1.872543313	2.148549025	1.862163493	1.942454013	1.944607763	2.153363036	1.889444346	1.91824009	1.91824009	1.857332496	1.69980725	1.97611694	1.937772437	1.810284608	1.350856914	1.703652932	1.76183222	1.526155201	1.829749141	1.892247855	1.705612777	1.856684634	1.804964551	1.505688594	1.723795655	1.829959567	1.814797946	1.957689689	1.736847193	2.22115485	1.883778356	1.715502878	1.546302761	1.84601278	1.846760873	1.843259637	1.711589866	1.880944904	1.797369779	1.889365614	1.842373102	1.969768268	1.6559362	1.747655987	2.124460844	1.868367239	1.741615638	1.714376498	1.78457199	1.919187812	1.785329835	1.703066467	1.786986555	2.105903075	1.876915428	1.873619077	1.87008657	1.693834616	2.107132235	1.769324938	1.94842867	1.696237701	1.964902937	1.927062185	1.802126531	1.88692743	1.949260106	1.797298482	1.997967598	1.765251836	1.928813472	1.789799858	1.768074131	1.68298183	1.724997835	2.040245667	1.721849865	1.224923847	1.765143252	1.80728992	1.698728794	1.674457695	1.847418078	1.818557825	1.469229699	1.847015047	1.684006537	1.746583429	2.070707406	1.707201316	1.881874621	1.726380997	1.816511458	1.736284284	1.75035253	1.86147144	1.65850612	1.798202772	2.284790036	1.81511812	1.874343677	1.751159862	1.838729087	1.88559764	1.78236757	1.692129071	1.738362792	1.575382003	1.832504101	1.868715958	1.764624398	1.764624398	2.155936018	1.726884354	1.757831625	1.858340083	1.989258045	1.750241001	1.731667256	1.694005009	1.748010798	1.643508035	2.076515345	1.733969413	1.838482904	1.992527787	1.944850102	1.851856466	1.890317196	1.770659385	1.688339953	1.803860013	1.693771168	1.804209077	1.813450331	1.866005519	1.891788543	1.929016302	1.718280475	1.864291733	1.798173212	1.939996087	1.887301628	1.865028856	1.476826118	1.556302501	1.614897216	1.614897216	1.954242509	2.083436294
-0.22184875	0.69019608	0	0.414973348	0.431363764	0.477121255	0.549135308	0.767412253	-0.0175666	0.492593941	-0.459844642	0.296708622	0.409158165	0.211940461	0.589577981	0.179710946	-0.002844251	-0.533670084	-0.478803587	-0.339221953	-0.443740927	-0.444316651	-0.148588634	-0.848877394	0.516781472	-0.474229513	-0.475034349	-0.330270905	1.232375723	0.501231116	1.136867289	0.155725158	0.593299411	1.144716543	0.334342498	-0.008220257	-0.053996379	0.251223719	0.753374633	0.864984066	-0.455335598	0.284669963	0.054604757	0.188424994	0.471714863	1.415282776	-0.025593287	-0.31219576	-0.161055631	-0.019744058	0.467329054	1.152288344	1.120573931	0.838849091	1.285557309	0.944482672	1.181843588	1.181843588	1.139879086	1.096910013	0.633468456	0.556302501	0.51851394	0.505149978	0.414973348	0.477121255	0.278753601	0.62324929	0.477121255	1.136720567	1.079181246	1.008600172	0.939519253	0.986771734	0.919078092	0.986771734	0.806179974	1.045322979	1.068185862	1.225309282	0.954242509	0.903089987	0.84509804	1.079181246	0.954242509	0.886490725	0.707570176	0.292855812	0.851955848	1.567026366	1.646403726	1.629409599	1.494154594	1.57863921	1.686636269	1.42975228	1.602059991	1.482873584	1.599883072	1.606381365	1.401400541	1.469822016	1.530199698	1.519827994	1.613841822	1.603144373	1.495544338	1.629409599	1.44870632	1.565847819	1.614897216	1.707570176	1.675778342	1.705863712	1.315970345	1.658011397	1.754348336	1.632457292	1.56937391	1.646403726	1.63447727	1.609594409	1.534026106	1.57054294	-0.638272164	-0.142667504	-0.537602002	-0.537602002	0.110252917	0.163459552	-0.236572006	0.194791758	0.074816441	-0.318758763	-0.318758763	-0.251811973	-0.200659451	0.041392685	-0.244125144	-0.247951552	-0.443697499	-0.346787486	-0.494850022	-0.494850022	-0.13667714	-0.047207557	0.041392685	0.056904851	0.18920949	0.199933711	-0.728158393	-1	-0.721246399	-0.721246399	-0.853871964	-1.096910013	-0.13076828	-0.537602002	-0.638272164	-0.37675071	-0.387216143	-0.866461092	-0.866461092	-1.096910013	-0.13076828	-0.754487332	-0.744727495	-3	-0.327902142	-0.48945499	0.020565245	-0.37675071	-1.031517051	-1.031517051	-1.045757491	0.078456818	-1.397940009	-0.022276395	-0.096910013	-0.349692477	-0.627087997	-0.619788758	0.408202421	-0.120330794	-1.508638306	-1.522878745	-0.093664958	-0.178586181	-0.356547324	-0.853871964	-0.841637508	-0.841637508	0.281831984	-1.096910013	0.241040547	0.229681842	-0.005243055	-0.004364805	-1.045757491	0.477121255	-0.581698709	-1.045757491	-0.312162683	0.079181246	-0.402304814	-0.397940009	-0.187755303	-3	-0.214670165	-0.214670165	-0.214670165	-0.214670165	-0.202752339	-0.201349355	-0.009661145	0.093071306	-0.361510743	-0.015922966	-1.207608311	-0.124599077	-0.079354999	-0.236572006	-0.237321436	-0.237321436	-0.088842391	0.124504225	-0.63638802	-0.405929256	-1.013228266	-1.013228266	-1	-0.279840697	0.132832158	-0.235077015	-0.019354529	-0.010550182	-1.327902142	-0.823908741	0	-1.031517051	-3	-1.087822598	-0.160814178	-0.187086643	-0.392544977	0.345399415	-0.258060922	-0.266000713	-0.455931956	-0.455931956	-0.064599104	-0.148741651	0.319314304	-0.104577454	-0.131943638	-0.229147988	-0.30980392	-0.30980392	0.041392685	-0.179142011	-0.140261434	-0.015472687	-0.045757491	-0.045757491	-0.119758224	-0.119186408	-0.173925197	-0.031517051	-0.200659451	0.064457989	0.095518042	-0.339134522	0.510754681	-0.168832316	0.351340232	-0.295849483	-0.306273051	0.207365037	-0.420216403	-0.044793462	-0.41453927	-0.41453927	-0.257274869	0.127104798	-0.27083521	0.08278537	0.095169351	-0.613488906	-0.588940644	-1.262604981	-1.107303568	0.215097725	-0.464857143	-0.506077544	0.196553216	0.060561139	0.229308743	-0.227671179	-1.332615262	-0.332821852	-0.807277895	-0.358916806	-0.888109665	-1.724314413	0.066206191	0.191880469	-0.237334165	0.193124598	-0.281587455	-0.285322594	-0.28481063	-0.091235863	-0.284448442	0.215066584	0.004909946	-0.226945307	-0.226945307	-0.115287823	-0.254150905	-0.332284171	-0.402032733	-0.096084119	0.070869372	-0.048283986	-0.250021402	0.078962315	-2.087086165	0.010389556	-1.262861303	-0.302786467	-1.307720432	-0.998771144	0.024207487	-0.918765082	-1.021051603	-1.360637833	-1.18268856	0.070270693	-0.12127844	-0.317344785	-0.27106921	0.31266111	-0.320454713	-1.523371444	-0.398789553	-0.410335054	-0.251811973	-0.306088202	-0.248439583	0.22143958	-0.021442458	0.143949857	0.58747378	0.854311476	-0.271350987	0.534577399	-0.122628654	-0.122628654	0.552668216	1.316149274	1.345177617	0.775319122	0.775319122	0.656062498	1.31299428	1.513869884	1.500236475	1.301897717	1.318146845	0.820844245	1.481299273	0.652633068	0.652633068	-0.167491087	-1.15490196	-1.15490196	1.041392685	1.374192359	-0.102285454	1.694951426	1.538102993	-0.023134035	1.311605563	1.157276703	0.392169149	0.392169149	0.620136055	-2.567005294	-1.211360503	0.485577167	-1.215287229	-1.360702218	0.304354653	0.022244365	0.295742704	-4.227196453	0.524826153	0.49693152	-0.358636876	-0.078745358	-0.540859154	-1.340195714	-0.287473422	0.471189399	0.074131444	-0.838582162	0.218575513	-0.144250367	0.03328923	-0.793791258	-0.176245005	-0.184125916	-1.230625269	0.062999216	0.169375216	0.080918936	-1.175902068	-0.123136481	0.250903856	-0.026854412	-0.733518957	0.268012645	0.274497921	0.274035927	-0.114674653	-0.212887398	0.183109902	0.556302501	0.099861909	0.558114325	-0.128073665	0.326608627	0.470326659	-0.796724952	0.30809237	0.420390848	0.533647989	0.297904303	-0.648055041	-0.733043994	-1.070439839	0.119007355	0.221669011	-3.324232899	0.205335396	-0.732665415	-0.434963096	0.564799583	0.2381884	-0.090481454	-0.088554163	0.395971717	0.456486364	-0.219080795	0.200923442	-0.650671481	-0.477711094	0.32820482	0.028095783	-0.01172818	-0.315648459	-0.631248035	0.535227376	0.265516008	-0.022565822	0.168346844	-0.171447353	0.681119416	0.275301358	0.580704741	-0.409493656	0.202826894	0.257473629	0.050405775	0.093674885	0.775467851	0.012643625	0.174846676	0.343104846	0.141311658	0.135665851	-0.725898528	-0.391289228	-0.295031386	0.219548725	0.025128272	0.022499432	-0.406713933	-0.406713933	0.301314969	-1.258014687	0.923916754	0.855344937	0.214360324	0.155145065	0.036326301	-0.020569245	0.052215297	0.058234957	-0.081297576	-0.497979663	0.107452384	0.435641675	0.37349138	0.830236631	-0.195664028	-0.159977044	-0.213637884	0.104039285	0.383429755	-0.32072966	-0.150460893	-0.215759723	-0.254513245	-0.278918884	-0.107787865	-0.236778664	-0.281008034	-1.892813271	-0.9575973	0.334297066	-0.456764862	0.492760389	-0.3400838	-0.3400838	1.412796429	1.456820462
0.491361694	1.155336037	0.838849091	1.255272505	1.222716471	1.255272505	1.590527993	0.726794402	1.787480924	2.203798402	2.283665122	2.077265942	2.262450684	2.288328807	2.02263161	2.176805955	1.572004128	1.869598758	2.050024491	1.910500388	1.986728307	1.799868808	1.920608391	1.83400579	2.086991142	1.38891303	1.412512625	1.557464273	1.803446693	1.993201492	0.410955656	2.105833288	0.97629907	1.688833942	1.301358312	1.760323567	1.609065454	1.748786134	0.556457046	1.993263545	2.241699907	1.271814643	1.224491703	1.116137456	2.416007375	2.418396011	2.678527113	0.201137667	-0.301674572	1.190642909	2.623452659	1.292256071	1.31386722	1.184691431	1.245512668	1.152288344	1.247973266	1.235528447	1.396199347	1.380211242	1.206825876	1.127104798	1.117271296	1.146128036	1.029383778	0.991226076	1.173186268	1.344392274	1.139879086	1.298853076	1.008600172	1.36361198	1.444044796	1.227886705	1.292256071	1.23299611	1.158362492	1.408239965	1.318063335	1.399673721	1.348304863	-0.397940009	-0.045757491	-0.045757491	0.301029996	-0.22184875	0	1.389765825	0.228706557	1.717670503	1.802089258	1.247973266	1.305351369	1.320146286	1.655138435	1.672097858	1.815577748	1.397940009	1.456366033	1.505149978	1.567026366	1.598790507	1.352182518	1.424881637	1.498310554	1.424881637	1.541579244	1.611723308	1.45331834	1.58546073	1.617000341	1.660865478	1.678518379	1.737192643	1.344392274	1.541579244	1.613841822	1.255272505	1.278753601	1.350248018	1.579783597	1.592176757	1.589949601	1.643452676	0.342422681	0.255272505	0.361727836	0.361727836	0.392696953	0.421603927	0.462397998	0.471291711	0.516931809	0.544068044	0.544068044	0.573799582	0.612783857	0.612783857	0.643452676	0.646207612	0.707570176	0.73239376	0.740362689	0.740362689	0.767452718	0.82549103	0.86923172	0.86923172	0.977128901	1.15697781	0.48258777	-0.22184875	0	0.380211242	0.579783597	0.934498451	1.247973266	0.301029996	0.361727836	0.462397998	0.568201724	0.58410497	0.58410497	0.934498451	1.247973266	1.353897005	1.354108439	0.559188189	-0.096910013	-0.062983893	-0.060910962	-0.045757491	-0.021363052	-0.021363052	0	0.114944416	0.380211242	0.462397998	0.792391689	1.057780177	1.261714776	1.26245109	1.478497502	0.520876382	0.563481085	0.568201724	0.789580712	0.801390105	0.832508913	0.929418926	0.930388618	0.930388618	0.802415781	0.862012051	-0.231621369	0.069298012	0.138302698	0.146128036	0.342422681	1.045322979	1.083144143	1.117271296	1.118350531	1.378397901	1.397818389	1.397940009	1.187661703	0.822168079	0.29136885	0.29136885	0.29136885	0.301029996	0.314825931	0.318063335	0.368472838	0.425371166	0.549003262	0.7930916	0.833784375	0.599322864	0.813247301	0.826074803	0.826528306	0.826528306	1.012162068	0.284656283	0.335257256	0.506684017	0.62076049	0.62076049	0.62324929	0.709863317	1.19089158	1.364138079	0.308025704	0.38309693	1.508085097	0.462397998	0.568201724	0.595936906	0.745933158	0.923670672	0.497793505	0.658774321	0.469527479	0.990921941	1.009620841	0.193124598	0.255272505	0.255272505	0.335136685	0.342422681	0.376941757	0.413299764	0.428134794	0.431363764	0.462397998	0.462397998	0.477121255	0.478133428	0.496929648	0.503926804	0.544068044	0.544068044	0.551815822	0.556302501	0.672097858	0.681241237	0.69019608	0.748188027	1.05300157	0.399846713	0.946010332	0.668748746	1.051757908	0.956600588	0.565020928	0.764176132	0.86923172	0.869407749	0.869935411	0.869935411	0.987040287	1.025305865	1.410726633	0.652729696	0.450403086	-0.888785221	-0.885423012	-0.81544695	-0.304883743	-0.182842284	-0.140163229	-0.115824364	-0.061724799	-0.05795159	-0.057932968	-0.037791636	0.002783635	0.030015294	0.038907241	0.039023203	0.039089186	0.049680877	0.054871646	0.06337147	0.063695831	0.064457989	0.067024801	0.073699349	0.079888446	0.082394797	0.088075971	0.088193348	0.094500879	0.098297536	0.098297536	0.125973968	0.152222271	0.15990083	0.165764055	0.183756578	0.185588944	0.196264654	0.2004211	0.219413218	0.225373293	0.23793032	0.242288675	0.256930523	0.264376336	0.267276707	0.2729642	0.27537068	0.287360346	0.297373564	0.307480463	0.312011263	0.334653515	0.390850379	0.434464564	0.462807762	0.483250642	0.578875106	0.599434189	0.629674967	0.651278014	0.655902615	0.656733355	0.661419026	0.842729463	0.889851802	0.934261266	1.020239415	1.15025294	0.756146479	0.756788199	0.756788199	0.77815125	1.106246005	1.123851641	1.273903666	1.273903666	1.459947517	1.21918434	1.491445743	1.530967682	0.895422546	1.226599905	0.756803686	1.345373731	1.436655522	1.436655522	-0.37675071	0.88155583	0.88155583	0.986771734	1.16373815	1.600141947	1.698965942	1.322392453	1.06172118	1.274477878	0.106208922	1.315151338	1.315151338	1.458939862	-0.964945303	-0.590817106	0.334996118	0.36413587	0.484395822	0.543406561	0.58954225	0.591769769	0.60531246	0.632036123	0.660215249	0.695741857	0.713194177	0.750572874	0.763809116	0.766905413	0.770249802	0.781207431	0.782363174	0.789295752	0.80459711	0.808094723	0.811154422	0.816568529	0.819756466	0.83383272	0.8378048	0.838321565	0.855724411	0.859447608	0.861183315	0.862656065	0.866216624	0.873547366	0.87385087	0.877213539	0.883457018	0.890719652	0.892895089	0.893840034	0.897627091	0.899543026	0.900449455	0.911184699	0.913156452	0.913554396	0.913674514	0.913726079	0.914545442	0.922814073	0.923849484	0.924962761	0.927007944	0.930644543	0.931903418	0.932021693	0.934244746	0.935627422	0.938110389	0.938907968	0.940595302	0.942836556	0.945414048	0.946178524	0.952031579	0.953474387	0.954040697	0.958752047	0.959582989	0.961937336	0.964692716	0.96889896	0.974224799	0.975621699	0.975775376	0.976087663	0.976603365	0.980261361	0.985255602	0.986706086	0.988329952	0.990835977	0.994976671	0.998560356	1.014154685	1.015703595	1.020442551	1.034635645	1.041060974	1.046816811	1.063093577	1.064136218	1.064169949	1.067935843	1.075075888	1.078532788	1.078974873	1.081732308	1.08507016	1.091322227	1.097569639	1.097569639	1.098600812	1.119430338	1.137492977	1.143409956	1.143599371	1.153181278	1.159141344	1.169647291	1.170905084	1.178529241	1.179348849	1.20674267	1.207699037	1.228100391	1.250109623	1.252812421	1.261890759	1.263361584	1.26724352	1.270370707	1.271007575	1.286129215	1.294393184	1.307873661	1.317583522	1.327462482	1.32980148	1.345077942	1.358478455	1.431880643	1.612945639	2.103244801	0.710298089	0.828659897	0.96922948	0.96922948	1.393399695	1.506913574];

%assignment of columns and rows
[inputs,Rows] = size(p);

%normalization between -1 and 1
[pn,ps] = mapminmax(p);
[tn,ts] = mapminmax(t);

%index creation for training, validation and test
p1 = 1:5:Rows;
p2 = 2:5:Rows;
p3 = 3:5:Rows;
p4 = 4:5:Rows;
p5 = 5:5:Rows;

%percentage assignment for: training(60%), validation(20%) and test(20%)
aa = [p1 p3 p5];
vv = [p2];
tt = [p4];

%Creation of training, validation and test vectors
val.P = pn(:,vv); val.T = tn(:,vv);
test.P = pn(:,tt); test.T = tn(:,tt);
trainP = pn(:,aa); trainT = tn(:,aa);

%initial parameters
hiddenNeurons = 1;
maxHiddenNeurons = 30;
iterations = 1000;
targetIdeal = 0.99;
flagHiddenNeurons = 1;
learningRate = 0.001;

%cycle that controls the number of hidden neurons
while(hiddenNeurons <= maxHiddenNeurons & flagHiddenNeurons == 1)
   
        flagLearningRate = 1;
        rInitial = 0.1;        
        n = 1;       
        rCalculated = [];        
        
        %cycle that creates the ANN
        while (flagLearningRate == 1)
            net = newff(minmax(pn(:,aa)),[hiddenNeurons 1],{'tansig' 'purelin'},'trainlm');            
            net.trainParam.mu = learningRate;
            net.trainParam.epochs = 3000;
            net.trainParam.goal = 1e-6;
            
            [net,tr] = train(net,trainP,trainT,[],[],val,test);
            a = sim(net,pn);
            [m,b,r] = postreg(a,tn);          
            rCalculated(n) = r;                       
            
            if (r > rInitial)
                rInitial = r;
                slope = m;
                intercept = b;
                
                %denormalize output of the ANN
                for i=1:length(t)
                    tmpOutput(i) = ( ((a(i)+1)/2)*(max(t)-min(t)) )+min(t);                    
                end
                outputANN=tmpOutput.^2;
                
                %calculate the RMSE
                for i=1:length(tCelsiusDegrees)
                    tmpDifference(i)=(tCelsiusDegrees(i)-outputANN(i));
                end
                tmp1=tmpDifference.^2;
                tmp2=sum(tmp1);
                rmse=sqrt(tmp2/length(tCelsiusDegrees));               
                                    
                %Relative contribution - Garson algorithm 1991                
                contribution=[];
                c=[];
                R=[];
                S=[];                
               
                for mm=1:hiddenNeurons        
                    for k=1:inputs
                        c(mm,k)=net.IW{1,1}(mm,k)*net.LW{2,1}(1,mm);
                    end
                end                
               
                for mm=1:hiddenNeurons
                    for k=1:inputs
                        R(mm,k)=abs(c(mm,k))/(abs(c(mm,1))+abs(c(mm,2))+abs(c(mm,3))+abs(c(mm,4)));
                    end
                end
                
                %different cases for the number of hidden neurons                
                switch hiddenNeurons
                    case 1                        
                        for k=1:inputs
                            S(k)=R(1,k);
                        end
                    case 2                        
                        for k=1:inputs
                            S(k)=R(1,k)+R(2,k);
                        end
                    case 3                        
                        for k=1:inputs 
                            S(k)=R(1,k)+R(2,k)+R(3,k);
                        end
                    case 4                        
                        for k=1:inputs
                            S(k)=R(1,k)+R(2,k)+R(3,k)+R(4,k);
                        end                      
                    case 5                        
                        for k=1:inputs
                            S(k)=R(1,k)+R(2,k)+R(3,k)+R(4,k)+R(5,k);
                        end
                    case 6
                        for k=1:inputs
                            S(k)=R(1,k)+R(2,k)+R(3,k)+R(4,k)+R(5,k)+R(6,k);
                        end
                    case 7
                        for k=1:inputs
                            S(k)=R(1,k)+R(2,k)+R(3,k)+R(4,k)+R(5,k)+R(6,k)+R(7,k);
                        end
                    case 8
                        for k=1:inputs
                            S(k)=R(1,k)+R(2,k)+R(3,k)+R(4,k)+R(5,k)+R(6,k)+R(7,k)+R(8,k);
                        end
                    case 9
                        for k=1:inputs
                            S(k)=R(1,k)+R(2,k)+R(3,k)+R(4,k)+R(5,k)+R(6,k)+R(7,k)+R(8,k)+R(9,k);
                        end
                    case 10
                        for k=1:inputs
                            S(k)=R(1,k)+R(2,k)+R(3,k)+R(4,k)+R(5,k)+R(6,k)+R(7,k)+R(8,k)+R(9,k)+R(10,k);
                        end
                    case 11
                        for k=1:inputs
                            S(k)=R(1,k)+R(2,k)+R(3,k)+R(4,k)+R(5,k)+R(6,k)+R(7,k)+R(8,k)+R(9,k)+R(10,k)+R(11,k);
                        end
                    case 12
                        for k=1:inputs
                            S(k)=R(1,k)+R(2,k)+R(3,k)+R(4,k)+R(5,k)+R(6,k)+R(7,k)+R(8,k)+R(9,k)+R(10,k)+R(11,k)+R(12,k);
                        end
                    case 13
                        for k=1:inputs
                            S(k)=R(1,k)+R(2,k)+R(3,k)+R(4,k)+R(5,k)+R(6,k)+R(7,k)+R(8,k)+R(9,k)+R(10,k)+R(11,k)+R(12,k)+R(13,k);
                        end
                    case 14
                        for k=1:inputs
                            S(k)=R(1,k)+R(2,k)+R(3,k)+R(4,k)+R(5,k)+R(6,k)+R(7,k)+R(8,k)+R(9,k)+R(10,k)+R(11,k)+R(12,k)+R(13,k)+R(14,k);
                        end
                    case 15
                        for k=1:inputs
                            S(k)=R(1,k)+R(2,k)+R(3,k)+R(4,k)+R(5,k)+R(6,k)+R(7,k)+R(8,k)+R(9,k)+R(10,k)+R(11,k)+R(12,k)+R(13,k)+R(14,k)+R(15,k);
                        end                        
                    case 16
                        for k=1:inputs
                            S(k)=R(1,k)+R(2,k)+R(3,k)+R(4,k)+R(5,k)+R(6,k)+R(7,k)+R(8,k)+R(9,k)+R(10,k)+R(11,k)+R(12,k)+R(13,k)+R(14,k)+R(15,k)+R(16,k);
                        end
                    case 17
                        for k=1:inputs
                            S(k)=R(1,k)+R(2,k)+R(3,k)+R(4,k)+R(5,k)+R(6,k)+R(7,k)+R(8,k)+R(9,k)+R(10,k)+R(11,k)+R(12,k)+R(13,k)+R(14,k)+R(15,k)+R(16,k)+R(17,k);
                        end
                    case 18
                        for k=1:inputs
                            S(k)=R(1,k)+R(2,k)+R(3,k)+R(4,k)+R(5,k)+R(6,k)+R(7,k)+R(8,k)+R(9,k)+R(10,k)+R(11,k)+R(12,k)+R(13,k)+R(14,k)+R(15,k)+R(16,k)+R(17,k)+R(18,k);
                        end
                    case 19
                        for k=1:inputs
                            S(k)=R(1,k)+R(2,k)+R(3,k)+R(4,k)+R(5,k)+R(6,k)+R(7,k)+R(8,k)+R(9,k)+R(10,k)+R(11,k)+R(12,k)+R(13,k)+R(14,k)+R(15,k)+R(16,k)+R(17,k)+R(18,k)+R(19,k);
                        end
                    case 20
                        for k=1:inputs
                            S(k)=R(1,k)+R(2,k)+R(3,k)+R(4,k)+R(5,k)+R(6,k)+R(7,k)+R(8,k)+R(9,k)+R(10,k)+R(11,k)+R(12,k)+R(13,k)+R(14,k)+R(15,k)+R(16,k)+R(17,k)+R(18,k)+R(19,k)+R(20,k);
                        end                       
                    otherwise
                        disp('option not found')
                end
                
                % contribution of each input    
                for k=1:inputs
                    contribution(k)=S(k)/(S(1)+S(2)+S(3)+S(4));
                end
                
                %saving weights of the ANN in txt files
                bestIteration=n;
                IW=net.IW{1,1};
                lw=net.LW{2,1};
                LW=lw';
                b1=net.b{1};
                b2=net.b{2};                
                filename1 = [num2str(hiddenNeurons),'_neurons_lr_',num2str(learningRate),'_IW','.txt'];
                filename2 = [num2str(hiddenNeurons),'_neurons_lr_',num2str(learningRate),'_b1','.txt'];
                filename3 = [num2str(hiddenNeurons),'_neurons_lr_',num2str(learningRate),'_LW','.txt'];
                filename4 = [num2str(hiddenNeurons),'_neurons_lr_',num2str(learningRate),'_b2','.txt'];              
                save(filename1,'IW','-ascii');
                save(filename2,'b1','-ascii');
                save(filename3,'LW','-ascii');
                save(filename4,'b2','-ascii');                
     
            end %end of if (r > rInitial)
            
            %if the ideal target is reached or all the iterations are executed
            if (r >= targetIdeal || n == iterations)
              flagLearningRate = 0;
            else              
              n = n+1
            end
        
        end % end of while (flagLearningRate == 1)
        
        %for report in txt
        rMax = max(rCalculated);
        rMin = min(rCalculated);
        rSort = sort(rCalculated);
        rMedian = median(rSort);        
        input1 = contribution(1);
        input2 = contribution(2);
        input3 = contribution(3);
        input4 = contribution(4);
       
        %creation of results vector
        results = [inputs, hiddenNeurons, iterations, learningRate, rMin, rMedian, rMax, rmse, slope, intercept, input1, input2, input3, input4, bestIteration];
        
        %save in file txt       
        dlmwrite('report_output_ANN18.txt',results,'-append','delimiter',',','newline','unix');
        results = [];        
          
    %we reset parameters for the next hidden neuron
    hiddenNeurons = hiddenNeurons+1;

end %end of while(hiddenNeurons <= maxHiddenNeurons & flagHiddenNeurons == 1)